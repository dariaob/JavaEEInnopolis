-- Установка схемы
SET search_path TO clinic_db;

-- Кабинеты
INSERT INTO offices (name, is_deleted) VALUES
('Терапевтический кабинет №1', false),
('Хирургический кабинет №2', false),
('Офтальмологический кабинет №3', false),
('Неврологический кабинет №4', false),
('Кардиологический кабинет №5', false);

-- Специализации
INSERT INTO specializations (name, description) VALUES
('Терапевт', 'Врач общей практики'),
('Хирург', 'Оперативное лечение заболеваний'),
('Офтальмолог', 'Лечение заболеваний глаз'),
('Невролог', 'Лечение нервной системы'),
('Кардиолог', 'Лечение сердечно-сосудистых заболеваний'),
('Отоларинголог', 'Лечение ЛОР-органов'),
('Травматолог', 'Лечение травм и повреждений');

-- Врачи
INSERT INTO doctors (name, phone, work_hours_from, work_hours_for, office_id, is_deleted) VALUES
('Иванов Петр Сергеевич', '+79161234567', '2023-01-01 08:00:00', '2023-01-01 16:00:00', 1, false),
('Смирнова Елена Владимировна', '+79161234568', '2023-01-01 09:00:00', '2023-01-01 17:00:00', 2, false),
('Кузнецов Андрей Михайлович', '+79161234569', '2023-01-01 10:00:00', '2023-01-01 18:00:00', 3, false),
('Петрова Ольга Игоревна', '+79161234570', '2023-01-01 08:30:00', '2023-01-01 16:30:00', 4, false),
('Васильев Дмитрий Александрович', '+79161234571', '2023-01-01 07:30:00', '2023-01-01 15:30:00', 5, false);

-- Связь врачей и специализаций (без is_primary)
INSERT INTO doctor_specializations (doctor_id, specialization_id) VALUES
(1, 1),
(2, 2),
(2, 7),
(3, 3),
(4, 4),
(5, 5);

-- Расписание
INSERT INTO doctor_schedule (doctor_id, day_of_week, start_time, end_time, office_id, is_deleted) VALUES
(1, 1, '08:00:00', '16:00:00', 1, false),
(1, 2, '08:00:00', '16:00:00', 1, false),
(2, 3, '09:00:00', '17:00:00', 2, false),
(3, 5, '10:00:00', '18:00:00', 3, false),
(4, 4, '08:30:00', '16:30:00', 4, false),
(5, 5, '07:30:00', '15:30:00', 5, false);

-- Карты пациентов
INSERT INTO patient_cards (symptoms, diagnosis, meds, is_deleted) VALUES
('Головная боль, температура', 'Грипп', 'Парацетамол, витамин C', false),
('Боль в спине', 'Остеохондроз', 'Диклофенак, массаж', false),
('Покраснение глаз, зуд', 'Конъюнктивит', 'Глазные капли', false),
('Головокружение, тошнота', 'Вегетососудистая дистония', 'Глицин, отдых', false),
('Боль в груди', 'Стенокардия', 'Нитроглицерин', false);

-- Пациенты
INSERT INTO patients (name, birth_date, phone, patient_card_id, is_deleted, insurance_id) VALUES
('Сидоров Алексей Николаевич', '1985-05-15', '+79161234572', 1, false, 1001),
('Ковалева Марина Викторовна', '1990-08-22', '+79161234573', 2, false, 1002),
('Федоров Игорь Станиславович', '1978-11-30', '+79161234574', 3, false, 1003),
('Михайлова Анна Сергеевна', '1995-03-10', '+79161234575', 4, false, 1004),
('Николаев Владислав Олегович', '1982-07-18', '+79161234576', 5, false, 1005);

-- Приемы
INSERT INTO appointments (date, doctor_id, patient_id, work_hours_from, work_hours_for, is_deleted, card_id, insurance_id, office_id) VALUES
('2023-06-01 09:00:00', 1, 1, '2023-06-01 09:00:00', '2023-06-01 09:30:00', false, 1, 1001, 1),
('2023-06-01 10:00:00', 2, 2, '2023-06-01 10:00:00', '2023-06-01 10:30:00', false, 2, 1002, 2),
('2023-06-02 11:00:00', 3, 3, '2023-06-02 11:00:00', '2023-06-02 11:30:00', false, 3, 1003, 3),
('2023-06-02 14:00:00', 4, 4, '2023-06-02 14:00:00', '2023-06-02 14:30:00', false, 4, 1004, 4),
('2023-06-03 15:00:00', 5, 5, '2023-06-03 15:00:00', '2023-06-03 15:30:00', false, 5, 1005, 5);


-- История изменений карт
INSERT INTO patient_cards_history
(card_id, changed_at, changed_by, old_diagnosis, new_diagnosis, old_meds, new_meds, change_reason)
VALUES
(1, '2023-05-15 10:00:00', 'doctor1', 'ОРВИ', 'Грипп', 'Аспирин', 'Парацетамол, витамин C', 'Уточнение диагноза'),
(2, '2023-05-20 11:30:00', 'doctor2', 'Растяжение мышц', 'Остеохондроз', 'Мази', 'Диклофенак, массаж', 'Результаты МРТ'),
(3, '2023-05-10 09:15:00', 'doctor3', NULL, 'Конъюнктивит', NULL, 'Глазные капли', 'Первичный диагноз'),
(4, '2023-05-25 14:45:00', 'doctor4', 'Мигрень', 'Вегетососудистая дистония', 'Обезболивающие', 'Глицин, отдых', 'Консультация невролога'),
(5, '2023-06-01 16:30:00', 'doctor5', NULL, 'Стенокардия', NULL, 'Нитроглицерин', 'Результаты ЭКГ');

-- Расширение для паролей
CREATE EXTENSION IF NOT EXISTS pgcrypto;

-- Пользователи
INSERT INTO users (username, password, roles, is_deleted) VALUES
('admin', crypt('admin123', gen_salt('bf')), ARRAY['ROLE_ADMIN'], false),
('doctor1', crypt('doctor1', gen_salt('bf')), ARRAY['ROLE_DOCTOR'], false),
('doctor2', crypt('doctor2', gen_salt('bf')), ARRAY['ROLE_DOCTOR'], false),
('patient1', crypt('patient1', gen_salt('bf')), ARRAY['ROLE_USER'], false),
('reception', crypt('reception1', gen_salt('bf')), ARRAY['ROLE_RECEPTION'], false);
